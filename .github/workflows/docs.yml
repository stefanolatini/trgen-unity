name: ğŸ“š Deploy Documentation (Simple)

on:
  push:
    branches: [ main ]
    paths:
      - 'README.md'
      - 'Documentation/**'
      - 'CHANGELOG.md'
      - 'docs/**'
      - '.github/workflows/docs-simple.yml'
  pull_request:
    branches: [ main ]
    paths:
      - 'README.md'
      - 'Documentation/**'
      - 'CHANGELOG.md'
      - 'docs/**'

# Sets permissions of the GITHUB_TOKEN to allow deployment to GitHub Pages
permissions:
  contents: read
  pages: write
  id-token: write

# Allow only one concurrent deployment
concurrency:
  group: "pages"
  cancel-in-progress: false

jobs:
  # Build job
  build:
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ“ Checkout Repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: ğŸ“¦ Setup Pages
        uses: actions/configure-pages@v4

      - name: ğŸ—ï¸ Create Documentation Structure
        run: |
          # Create docs directory structure
          mkdir -p docs
          mkdir -p docs/api
          mkdir -p docs/examples
          mkdir -p docs/assets
          
          # Copy main documentation files
          cp README.md docs/
          cp CHANGELOG.md docs/changelog.md
          cp LICENSE docs/license.md
          
          # Copy images and assets if they exist
          if [ -d "images" ]; then
            cp -r images docs/assets/
          fi
          
          echo "ğŸ“‹ Documentation structure created"

      - name: ğŸ“ Generate Static Documentation
        run: |
          # Create main index.html using the existing docsify setup
          # This creates a fully static site that GitHub Pages can serve directly
          
          # The docs directory already contains all the necessary files:
          # - index.html (docsify configuration)
          # - _sidebar.md (navigation)
          # - _navbar.md (top navigation)
          # - _coverpage.md (cover page)
          # - README.md (main content)
          # - API documentation in api/
          # - Examples in examples/
          
          echo "ğŸ“ Static documentation ready"
          
          # List files for verification
          echo "ğŸ“ Documentation files:"
          find docs -type f -name "*.md" -o -name "*.html" | head -20

      - name: ğŸ“‹ Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: ./docs

  # Deployment job
  deploy:
    if: github.ref == 'refs/heads/main'
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    needs: build
    steps:
      - name: ğŸš€ Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4

      - name: ğŸ‰ Deployment Success
        run: |
          echo "âœ… Documentation successfully deployed!"
          echo "ğŸŒ Site URL: ${{ steps.deployment.outputs.page_url }}"
          echo "ğŸ“š Your documentation is now live on GitHub Pages!"